<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <!-- Essential meta tags for mobile-first optimization -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    
    <!-- Security and performance -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self' ws: wss: localhost:* 127.0.0.1:*; img-src 'self' data: blob:; font-src 'self' data:; manifest-src 'self'; fetch-src 'self' data: blob:;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <!-- PWA and mobile optimization -->
    <meta name="theme-color" content="#1e1e1e" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="VSCode Tunnel">
    <meta name="application-name" content="VSCode Tunnel">
    <meta name="msapplication-TileColor" content="#1e1e1e">
    <meta name="msapplication-config" content="./browserconfig.xml">
    
    <!-- SEO and accessibility -->
    <meta name="description" content="Mobile-first web automation interface for Visual Studio Code with enhanced accessibility and offline support">
    <meta name="keywords" content="vscode, automation, accessibility, mobile, progressive web app">
    <meta name="author" content="VS Code Web Automation Tunnel">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Open Graph for better sharing -->
    <meta property="og:title" content="VS Code Web Automation Tunnel">
    <meta property="og:description" content="Mobile-first web automation interface for Visual Studio Code">
    <meta property="og:type" content="website">
    <meta property="og:image" content="./assets/icons/icon-512.png">
    
    <!-- Title -->
    <title>VS Code Web Automation Tunnel</title>
    
    <!-- PWA manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Icons for different platforms -->
    <link rel="icon" type="image/svg+xml" href="./assets/icons/icon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/icons/icon-16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/icons/apple-touch-icon.png">
    <link rel="mask-icon" href="./assets/icons/safari-pinned-tab.svg" color="#007acc">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="./js/enhanced.js" as="script">
    <link rel="preload" href="./js/basic.js" as="script">
    <link rel="preconnect" href="ws://localhost" crossorigin>
    <link rel="preconnect" href="wss://localhost" crossorigin>
    
    <!-- DNS prefetch for potential external resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    
    <!-- Tailwind CSS Output -->
    <link rel="stylesheet" href="styles/output.css" id="tailwindStyles">
    
    <!-- Modular CSS Stylesheets -->
    <link rel="stylesheet" href="styles/critical.css" id="criticalStyles">
    <link rel="stylesheet" href="styles/loading.css" id="loadingStyles">
    <link rel="stylesheet" href="styles/error-fallback.css" id="errorFallbackStyles">
</head>

<body class="vscode-theme-dark" role="application" aria-label="VS Code Web Automation Tunnel">
    <!-- Skip navigation for accessibility -->
    <a href="#main-content" class="skip-link" aria-label="Skip to main content">Skip to main content</a>
    
    <!-- Loading screen with accessibility support -->
    <div id="loadingScreen" class="loading-screen" role="status" aria-live="polite" aria-label="Application loading">
        <div class="loading-spinner" aria-hidden="true"></div>
        <div class="loading-text" id="loadingText">Initializing VS Code Web Automation Tunnel...</div>
        <div class="loading-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Loading progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>
    
    <!-- Basic UI Container -->
    <div id="basicApp" class="ui-container basic-ui" style="display: none;" role="main" aria-label="Basic user interface">
        <!-- Basic UI content will be loaded from templates/basic-ui.html -->
    </div>

    <!-- Enhanced UI Container -->
    <div id="enhancedApp" class="ui-container enhanced-ui app-container" style="display: none;" 
         role="main" aria-label="Enhanced user interface">
        <div id="app" class="app-shell" role="application" aria-label="Enhanced VS Code automation interface">
            <!-- Enhanced UI components will be dynamically loaded here -->
        </div>
    </div>

    <!-- UI Mode Toggle (for development/debugging) -->
    <div class="ui-toggle" id="uiToggle" role="complementary" aria-label="Development tools"
         style="position: fixed; top: 10px; right: 10px; z-index: 9999; display: none;">
        <button id="toggleUIButton" type="button" class="toggle-btn" 
                aria-label="Toggle between basic and enhanced UI modes" title="Toggle UI Mode">
            <span aria-hidden="true">ðŸ”„</span>
            <span class="sr-only">Toggle UI</span>
        </button>
    </div>
    
    <!-- Accessibility and no-JavaScript fallback -->
    <noscript>
        <div class="no-js-fallback" role="alert" aria-live="assertive">
            <!-- Content loaded from templates/no-js-fallback.html for users without JavaScript -->
            <div class="fallback-container">
                <header class="fallback-header">
                    <h1>JavaScript Required</h1>
                    <p class="fallback-subtitle">VS Code Web Automation Tunnel</p>
                </header>
                <main class="fallback-content">
                    <section class="fallback-message">
                        <h2>Enable JavaScript to Continue</h2>
                        <p>This application requires JavaScript to provide the full VS Code automation experience. 
                           Please enable JavaScript in your browser settings and refresh the page.</p>
                    </section>
                </main>
                <footer class="fallback-footer">
                    <p>For technical support, please refer to the VS Code documentation or contact your system administrator.</p>
                </footer>
            </div>
        </div>
    </noscript>

    <!-- Modular JavaScript Modules -->
    <script src="js/template-loader.js"></script>
    <script src="js/utilities.js"></script>
    <script src="js/error-handling.js"></script>
    <script src="js/ui-loader.js"></script>
    <script src="js/main-init.js"></script>
    
    <!-- Progressive Enhancement Detection System -->
    <script src="./js/utils/ProgressiveEnhancement.js"></script>
    <script src="./js/utils/LoadingStrategyEngine.js"></script>
    <script src="./js/services/PerformanceMonitoringService.js"></script>
    <script src="./js/progressive-enhancement-init.js"></script>
</body>
</html>
